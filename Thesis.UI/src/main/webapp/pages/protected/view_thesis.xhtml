<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:thesis="http://java.sun.com/jsf/composite/thesis"
      xmlns:p="http://primefaces.org/ui">
<f:metadata>
    <f:event type="preRenderView" listener="#{viewThesisBean.init}"/>
</f:metadata>
<ui:composition template="/template/common/layout.xhtml">
    <ui:define name="head">
        <h:outputScript library="js" name="thesis_viewer.js"/>
    </ui:define>
    <ui:define name="content">
        <ui:param name="lastWeek"
                  value="#{studentActivity == viewThesisBean.thesis.studentActivityList.get(viewThesisBean.thesis.studentActivityList.size() - 1)}"/>

        <ui:repeat value="#{viewThesisBean.thesis.studentActivityList}" var="studentActivity">
            <div id="student_activity_#{studentActivity.id}"
                 class="student_activity_item #{viewThesisBean.getRowStyle(studentActivity, lastWeek)}">
                <p:outputLabel value="#{studentActivity.startDate}">
                    <f:convertDateTime locale="tr" dateStyle="medium"/>
                </p:outputLabel>
                -
                <p:outputLabel value="#{studentActivity.endDate}">
                    <f:convertDateTime locale="tr" dateStyle="medium"/>
                </p:outputLabel>

                <div id="item_student_activity_#{studentActivity.id}"
                     class="student_activity_detail"
                     style="display: none">
                    <p:outputLabel rendered="#{studentActivity.loadDocument}">
                        Bu haftaya ait PDF yüklenmiş. İlgili dokümana ulaşabilmek için
                        <a href="#{request.contextPath}/resources/pdf/#{studentActivity.documentName}"
                           target="_blank">
                            tıklayınız!
                        </a>
                        <br/>
                        <br/>
                    </p:outputLabel>

                    <p:outputLabel rendered="#{studentActivity.posterName ne null}">
                        Tez posteri yüklenmiş, açmak için
                        <a href="#{request.contextPath}/resources/pdf/#{studentActivity.posterName}"
                           target="_blank">
                            tıklayınız!
                        </a>
                        <br/>
                        <br/>
                    </p:outputLabel>

                    <p:outputLabel rendered="#{studentActivity.codeName ne null}">
                        Tez'e ait kaynakları indirmek için
                        <a href="#{request.contextPath}/resources/pdf/#{studentActivity.codeName}"
                           target="_blank">
                            tıklayınız!
                        </a>
                        <br/>
                        <br/>
                    </p:outputLabel>

                    <p:outputLabel rendered="#{lastWeek and request.isUserInRole('ROLE_STUDENT')}"
                                   value="Bu haftaya bitirme tezinizi, tez posterinizi ve diğer dokümanlarınızı yükleyiniz."/>

                    <br />

                    <p:commandLink value="Yorumları incele"
                                   update=":comments_dialog_form:comments_dialog_"
                                   actionListener="#{viewThesisBean.performReadAllComments}"
                                   oncomplete="PF('comments_dialog').show();"/>
                    <br/>
                    <p:commandLink value="Yüklenen dokümanlar"
                                   rendered="#{!lastWeek and request.isUserInRole('ROLE_STUDENT')}"
                                   update=":file_upload_dialog_form:file_upload_dialog_"
                                   oncomplete="PF('file_upload_dialog').show();"/>

                    <p:commandLink value="Yüklenen dokümanlar"
                                   rendered="#{lastWeek and request.isUserInRole('ROLE_STUDENT')}"
                                   update=":file_upload_dialog_for_lastweek_form:file_upload_dialog_for_lastweek_"
                                   oncomplete="PF('file_upload_dialog_for_lastweek').show();"/>
                    <br />

                    <h:panelGrid id="point" columns="2" styleClass="standart_panel"
                                 rendered="#{request.isUserInRole('ROLE_THESIS_MANAGER')}">
                        <p:inputText value="#{studentActivity.point}" id="point_val">
                            <f:validateLongRange maximum="100" minimum="0"/>
                        </p:inputText>

                        <p:message for="point_val"/>

                        <p:commandButton value="Puanla"
                                         process="point"
                                         update="point"
                                         actionListener="#{viewThesisBean.evaluate}"/>
                    </h:panelGrid>
                </div>
            </div>
        </ui:repeat>
        <br />
        <p:outputLabel value="#{viewThesisBean.thesis.student.name} #{viewThesisBean.thesis.student.surname}" />
        <h:panelGrid styleClass="standart_panel"
                     columns="2">

            <p:outputLabel value="Ortalama : " />
            <p:outputLabel value="#{viewThesisBean.averageOfAllWeeks}" />
        </h:panelGrid>

        <p:remoteCommand name="selectStudentActivity"
                         actionListener="#{viewThesisBean.selectStudentActivity}"
                         process="@this"/>
    </ui:define>
</ui:composition>
</html>